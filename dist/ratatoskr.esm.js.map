{"version":3,"file":"ratatoskr.esm.js","sources":["../node_modules/tslib/tslib.es6.js","../node_modules/rollup-plugin-node-builtins/src/es6/events.js","../src/client.ts","../src/extensions/resume.ts","../src/extensions/presence-batch.ts"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = Object.setPrototypeOf ||\r\n    ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n    function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = Object.assign || function __assign(t) {\r\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n        s = arguments[i];\r\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n    }\r\n    return t;\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n            t[p[i]] = s[p[i]];\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = y[op[0] & 2 ? \"return\" : op[0] ? \"throw\" : \"next\"]) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [0, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r);  }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { if (o[n]) i[n] = function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; }; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator];\r\n    return m ? m.call(o) : typeof __values === \"function\" ? __values(o) : o[Symbol.iterator]();\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n","'use strict';\n\nvar domain;\n\n// This constructor is used to store event handlers. Instantiating this is\n// faster than explicitly calling `Object.create(null)` to get a \"clean\" empty\n// object (tested with v8 v4.9).\nfunction EventHandlers() {}\nEventHandlers.prototype = Object.create(null);\n\nfunction EventEmitter() {\n  EventEmitter.init.call(this);\n}\nexport default EventEmitter;\nexport {EventEmitter};\n\n// nodejs oddity\n// require('events') === require('events').EventEmitter\nEventEmitter.EventEmitter = EventEmitter\n\nEventEmitter.usingDomains = false;\n\nEventEmitter.prototype.domain = undefined;\nEventEmitter.prototype._events = undefined;\nEventEmitter.prototype._maxListeners = undefined;\n\n// By default EventEmitters will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nEventEmitter.defaultMaxListeners = 10;\n\nEventEmitter.init = function() {\n  this.domain = null;\n  if (EventEmitter.usingDomains) {\n    // if there is an active domain, then attach to it.\n    if (domain.active && !(this instanceof domain.Domain)) {\n      this.domain = domain.active;\n    }\n  }\n\n  if (!this._events || this._events === Object.getPrototypeOf(this)._events) {\n    this._events = new EventHandlers();\n    this._eventsCount = 0;\n  }\n\n  this._maxListeners = this._maxListeners || undefined;\n};\n\n// Obviously not all Emitters should be limited to 10. This function allows\n// that to be increased. Set to zero for unlimited.\nEventEmitter.prototype.setMaxListeners = function setMaxListeners(n) {\n  if (typeof n !== 'number' || n < 0 || isNaN(n))\n    throw new TypeError('\"n\" argument must be a positive number');\n  this._maxListeners = n;\n  return this;\n};\n\nfunction $getMaxListeners(that) {\n  if (that._maxListeners === undefined)\n    return EventEmitter.defaultMaxListeners;\n  return that._maxListeners;\n}\n\nEventEmitter.prototype.getMaxListeners = function getMaxListeners() {\n  return $getMaxListeners(this);\n};\n\n// These standalone emit* functions are used to optimize calling of event\n// handlers for fast cases because emit() itself often has a variable number of\n// arguments and can be deoptimized because of that. These functions always have\n// the same number of arguments and thus do not get deoptimized, so the code\n// inside them can execute faster.\nfunction emitNone(handler, isFn, self) {\n  if (isFn)\n    handler.call(self);\n  else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      listeners[i].call(self);\n  }\n}\nfunction emitOne(handler, isFn, self, arg1) {\n  if (isFn)\n    handler.call(self, arg1);\n  else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      listeners[i].call(self, arg1);\n  }\n}\nfunction emitTwo(handler, isFn, self, arg1, arg2) {\n  if (isFn)\n    handler.call(self, arg1, arg2);\n  else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      listeners[i].call(self, arg1, arg2);\n  }\n}\nfunction emitThree(handler, isFn, self, arg1, arg2, arg3) {\n  if (isFn)\n    handler.call(self, arg1, arg2, arg3);\n  else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      listeners[i].call(self, arg1, arg2, arg3);\n  }\n}\n\nfunction emitMany(handler, isFn, self, args) {\n  if (isFn)\n    handler.apply(self, args);\n  else {\n    var len = handler.length;\n    var listeners = arrayClone(handler, len);\n    for (var i = 0; i < len; ++i)\n      listeners[i].apply(self, args);\n  }\n}\n\nEventEmitter.prototype.emit = function emit(type) {\n  var er, handler, len, args, i, events, domain;\n  var needDomainExit = false;\n  var doError = (type === 'error');\n\n  events = this._events;\n  if (events)\n    doError = (doError && events.error == null);\n  else if (!doError)\n    return false;\n\n  domain = this.domain;\n\n  // If there is no 'error' event listener then throw.\n  if (doError) {\n    er = arguments[1];\n    if (domain) {\n      if (!er)\n        er = new Error('Uncaught, unspecified \"error\" event');\n      er.domainEmitter = this;\n      er.domain = domain;\n      er.domainThrown = false;\n      domain.emit('error', er);\n    } else if (er instanceof Error) {\n      throw er; // Unhandled 'error' event\n    } else {\n      // At least give some kind of context to the user\n      var err = new Error('Uncaught, unspecified \"error\" event. (' + er + ')');\n      err.context = er;\n      throw err;\n    }\n    return false;\n  }\n\n  handler = events[type];\n\n  if (!handler)\n    return false;\n\n  var isFn = typeof handler === 'function';\n  len = arguments.length;\n  switch (len) {\n    // fast cases\n    case 1:\n      emitNone(handler, isFn, this);\n      break;\n    case 2:\n      emitOne(handler, isFn, this, arguments[1]);\n      break;\n    case 3:\n      emitTwo(handler, isFn, this, arguments[1], arguments[2]);\n      break;\n    case 4:\n      emitThree(handler, isFn, this, arguments[1], arguments[2], arguments[3]);\n      break;\n    // slower\n    default:\n      args = new Array(len - 1);\n      for (i = 1; i < len; i++)\n        args[i - 1] = arguments[i];\n      emitMany(handler, isFn, this, args);\n  }\n\n  if (needDomainExit)\n    domain.exit();\n\n  return true;\n};\n\nfunction _addListener(target, type, listener, prepend) {\n  var m;\n  var events;\n  var existing;\n\n  if (typeof listener !== 'function')\n    throw new TypeError('\"listener\" argument must be a function');\n\n  events = target._events;\n  if (!events) {\n    events = target._events = new EventHandlers();\n    target._eventsCount = 0;\n  } else {\n    // To avoid recursion in the case that type === \"newListener\"! Before\n    // adding it to the listeners, first emit \"newListener\".\n    if (events.newListener) {\n      target.emit('newListener', type,\n                  listener.listener ? listener.listener : listener);\n\n      // Re-assign `events` because a newListener handler could have caused the\n      // this._events to be assigned to a new object\n      events = target._events;\n    }\n    existing = events[type];\n  }\n\n  if (!existing) {\n    // Optimize the case of one listener. Don't need the extra array object.\n    existing = events[type] = listener;\n    ++target._eventsCount;\n  } else {\n    if (typeof existing === 'function') {\n      // Adding the second element, need to change to array.\n      existing = events[type] = prepend ? [listener, existing] :\n                                          [existing, listener];\n    } else {\n      // If we've already got an array, just append.\n      if (prepend) {\n        existing.unshift(listener);\n      } else {\n        existing.push(listener);\n      }\n    }\n\n    // Check for listener leak\n    if (!existing.warned) {\n      m = $getMaxListeners(target);\n      if (m && m > 0 && existing.length > m) {\n        existing.warned = true;\n        var w = new Error('Possible EventEmitter memory leak detected. ' +\n                            existing.length + ' ' + type + ' listeners added. ' +\n                            'Use emitter.setMaxListeners() to increase limit');\n        w.name = 'MaxListenersExceededWarning';\n        w.emitter = target;\n        w.type = type;\n        w.count = existing.length;\n        emitWarning(w);\n      }\n    }\n  }\n\n  return target;\n}\nfunction emitWarning(e) {\n  typeof console.warn === 'function' ? console.warn(e) : console.log(e);\n}\nEventEmitter.prototype.addListener = function addListener(type, listener) {\n  return _addListener(this, type, listener, false);\n};\n\nEventEmitter.prototype.on = EventEmitter.prototype.addListener;\n\nEventEmitter.prototype.prependListener =\n    function prependListener(type, listener) {\n      return _addListener(this, type, listener, true);\n    };\n\nfunction _onceWrap(target, type, listener) {\n  var fired = false;\n  function g() {\n    target.removeListener(type, g);\n    if (!fired) {\n      fired = true;\n      listener.apply(target, arguments);\n    }\n  }\n  g.listener = listener;\n  return g;\n}\n\nEventEmitter.prototype.once = function once(type, listener) {\n  if (typeof listener !== 'function')\n    throw new TypeError('\"listener\" argument must be a function');\n  this.on(type, _onceWrap(this, type, listener));\n  return this;\n};\n\nEventEmitter.prototype.prependOnceListener =\n    function prependOnceListener(type, listener) {\n      if (typeof listener !== 'function')\n        throw new TypeError('\"listener\" argument must be a function');\n      this.prependListener(type, _onceWrap(this, type, listener));\n      return this;\n    };\n\n// emits a 'removeListener' event iff the listener was removed\nEventEmitter.prototype.removeListener =\n    function removeListener(type, listener) {\n      var list, events, position, i, originalListener;\n\n      if (typeof listener !== 'function')\n        throw new TypeError('\"listener\" argument must be a function');\n\n      events = this._events;\n      if (!events)\n        return this;\n\n      list = events[type];\n      if (!list)\n        return this;\n\n      if (list === listener || (list.listener && list.listener === listener)) {\n        if (--this._eventsCount === 0)\n          this._events = new EventHandlers();\n        else {\n          delete events[type];\n          if (events.removeListener)\n            this.emit('removeListener', type, list.listener || listener);\n        }\n      } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length; i-- > 0;) {\n          if (list[i] === listener ||\n              (list[i].listener && list[i].listener === listener)) {\n            originalListener = list[i].listener;\n            position = i;\n            break;\n          }\n        }\n\n        if (position < 0)\n          return this;\n\n        if (list.length === 1) {\n          list[0] = undefined;\n          if (--this._eventsCount === 0) {\n            this._events = new EventHandlers();\n            return this;\n          } else {\n            delete events[type];\n          }\n        } else {\n          spliceOne(list, position);\n        }\n\n        if (events.removeListener)\n          this.emit('removeListener', type, originalListener || listener);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.removeAllListeners =\n    function removeAllListeners(type) {\n      var listeners, events;\n\n      events = this._events;\n      if (!events)\n        return this;\n\n      // not listening for removeListener, no need to emit\n      if (!events.removeListener) {\n        if (arguments.length === 0) {\n          this._events = new EventHandlers();\n          this._eventsCount = 0;\n        } else if (events[type]) {\n          if (--this._eventsCount === 0)\n            this._events = new EventHandlers();\n          else\n            delete events[type];\n        }\n        return this;\n      }\n\n      // emit removeListener for all listeners on all events\n      if (arguments.length === 0) {\n        var keys = Object.keys(events);\n        for (var i = 0, key; i < keys.length; ++i) {\n          key = keys[i];\n          if (key === 'removeListener') continue;\n          this.removeAllListeners(key);\n        }\n        this.removeAllListeners('removeListener');\n        this._events = new EventHandlers();\n        this._eventsCount = 0;\n        return this;\n      }\n\n      listeners = events[type];\n\n      if (typeof listeners === 'function') {\n        this.removeListener(type, listeners);\n      } else if (listeners) {\n        // LIFO order\n        do {\n          this.removeListener(type, listeners[listeners.length - 1]);\n        } while (listeners[0]);\n      }\n\n      return this;\n    };\n\nEventEmitter.prototype.listeners = function listeners(type) {\n  var evlistener;\n  var ret;\n  var events = this._events;\n\n  if (!events)\n    ret = [];\n  else {\n    evlistener = events[type];\n    if (!evlistener)\n      ret = [];\n    else if (typeof evlistener === 'function')\n      ret = [evlistener.listener || evlistener];\n    else\n      ret = unwrapListeners(evlistener);\n  }\n\n  return ret;\n};\n\nEventEmitter.listenerCount = function(emitter, type) {\n  if (typeof emitter.listenerCount === 'function') {\n    return emitter.listenerCount(type);\n  } else {\n    return listenerCount.call(emitter, type);\n  }\n};\n\nEventEmitter.prototype.listenerCount = listenerCount;\nfunction listenerCount(type) {\n  var events = this._events;\n\n  if (events) {\n    var evlistener = events[type];\n\n    if (typeof evlistener === 'function') {\n      return 1;\n    } else if (evlistener) {\n      return evlistener.length;\n    }\n  }\n\n  return 0;\n}\n\nEventEmitter.prototype.eventNames = function eventNames() {\n  return this._eventsCount > 0 ? Reflect.ownKeys(this._events) : [];\n};\n\n// About 1.5x faster than the two-arg version of Array#splice().\nfunction spliceOne(list, index) {\n  for (var i = index, k = i + 1, n = list.length; k < n; i += 1, k += 1)\n    list[i] = list[k];\n  list.pop();\n}\n\nfunction arrayClone(arr, i) {\n  var copy = new Array(i);\n  while (i--)\n    copy[i] = arr[i];\n  return copy;\n}\n\nfunction unwrapListeners(arr) {\n  var ret = new Array(arr.length);\n  for (var i = 0; i < ret.length; ++i) {\n    ret[i] = arr[i].listener || arr[i];\n  }\n  return ret;\n}\n","import { EventEmitter } from 'events';\nimport * as WebSocket from 'ws';\nimport { Ack, Error, Other, Auth, Chat, PresenceChange, UserTyping, Ping, TeamJoin, TeamLeave, Outbound, Inbound } from './message-types';\n\nconst shortid = require('shortid');\nconst debug: debug.IDebugger = require('debug')('ratatoskr:client');\n\nexport enum ConnectionStatus {\n    Disconnected = 0,\n    Connecting = 1,\n    Connected = 2,\n    Authenticated = 3\n}\n\nexport interface ConnectionOptions {\n    endpoint?: string;\n    authorization?: string | AuthorizationFunc;\n    resource?: string;\n    agent?: string;\n    timeout?: number;\n    extensions?: any[];\n}\n\nexport interface PendingAckContext {\n    id: string;\n    ok: (data: any) => void;\n    error: (err: any) => void;\n}\n\nexport interface AuthorizationFunc {\n    (): string;\n}\n\nexport interface Extension {\n    init(client: Client);\n}\n\nexport interface ExtensionAsFunc {\n    (client: Client): void;\n}\n\nexport enum MessageSendErrorCause {\n    NoConnection = 0,\n    NoAuth = 1,\n    NoAck = 2,\n    Serialization = 3,\n    Transport = 4,\n    Promise = 5\n}\n\nexport class MessageSendError extends Error {\n    data: Outbound;\n    cause: MessageSendErrorCause;\n    source: any;\n\n    constructor(message: string, cause: MessageSendErrorCause, source?: any, data?: Outbound) {\n        super(message);\n\n        this.cause = cause;\n        this.source = source;\n        this.data = data;\n    }\n}\n\n/**\n */\nexport class Client extends EventEmitter {\n    status: ConnectionStatus = ConnectionStatus.Disconnected;\n    resource: string;\n    agent: string;\n    endpoint: string;\n    authorization: string | AuthorizationFunc;\n    timeout: number = 5 * 1000;\n\n    protected _socket: WebSocket;\n    protected _needsAck: {[id: string]: PendingAckContext} = {};\n\n    constructor({ endpoint, authorization, timeout = 5 * 1000, resource = '', agent = 'Ratatoskr', extensions = [] }: ConnectionOptions = {}) {\n        super();\n\n        this.agent = agent;\n        this.resource = resource;\n        this.endpoint = endpoint;\n        this.authorization = authorization;\n        this.timeout = timeout;\n\n        extensions.forEach((ext) => this.use(ext));\n    }\n\n    use(ext: Extension);\n    use(ext: ExtensionAsFunc);\n    use(ext: any) {\n        if (typeof ext.prototype.init === 'function') {\n            (new ext()).init(this);\n        } else if (typeof ext.init === 'function') {\n            ext.init(this);\n        } else if (typeof ext === 'function') {\n            ext(this);\n        }\n    }\n\n    nextId() {\n        return shortid.generate();\n    }\n\n    connect(): void {\n        if (this.status !== ConnectionStatus.Disconnected) {\n            return;\n        }\n\n        this.status = ConnectionStatus.Connecting;\n\n        debug('connect endpoint=', this.endpoint);\n\n        this.emit('connecting');\n\n        const socket = new WebSocket(this.endpoint, ['ratatoskr']);\n\n        socket.onopen = (evt) => {\n            debug('connect onopen=', evt);\n\n            this._wsBind(socket);\n        };\n        socket.onerror = (evt) => {\n            debug('connect onerror=', evt);\n\n            this.emit('transport:error', evt);\n            this._wsDisconnect(socket, evt);\n        };\n        socket.onclose = (evt) => {\n            debug('connect onclose=', evt);\n\n            this.emit('transport:close', evt);\n            this._wsDisconnect(socket, evt);\n        };\n    }\n\n    disconnect(reason: any = this): void {\n        this._wsDisconnect(this._socket, reason);\n    }\n\n    protected _wsDisconnect(socket: WebSocket, reason?: any): void {\n        debug('disconnect reason=', reason);\n\n        try {\n            if (socket) {\n                socket.onopen = null;\n                socket.onerror = null;\n                socket.onmessage = null;\n                socket.onclose = null;\n                socket.close();\n            }\n        } catch (err) {\n            // nothing to do here, we are releasing the socket\n        } finally {\n            this._socket = null;\n        }\n\n        Object.keys(this._needsAck).forEach((k) => {\n            this._needsAck[k].error(reason);\n        }), this._needsAck = {};\n\n        this.status = ConnectionStatus.Disconnected;\n\n        this.emit('disconnected', reason);\n    }\n\n    protected _wsBind(socket: WebSocket): void {\n        socket.onopen = null;\n        socket.onerror = this._wsError.bind(this);\n        socket.onmessage = this._wsMessage.bind(this);\n        socket.onclose = this._wsClose.bind(this);\n\n        this._socket = socket;\n\n        this.status = ConnectionStatus.Connected;\n\n        this.emit('connected');\n\n        let auth: string;\n\n        auth = typeof this.authorization === 'function' ? (<AuthorizationFunc>this.authorization)() : <string>this.authorization;\n\n        const message = <Auth>{\n            id: this.nextId(),\n            type: 'auth',\n            authorization: auth\n        };\n\n        if (this.agent) message.agent = this.agent;\n        if (this.resource) message.resource = this.resource;\n\n        this._wsSend(message).then((ack) => {\n            debug('authentication ack=', ack);\n\n            this.status = ConnectionStatus.Authenticated;\n            this.emit('authenticated', ack);\n        }, (err) => {\n            debug('authentication error=', err);\n\n            this.emit('protocol:error', err);\n            this._wsDisconnect(this._socket, err);\n        });\n    }\n\n    protected _wsInboundError(message: Error) {\n        if (message.code === 'auth_failed') {\n            debug('authentication failure=', message);\n            this._wsDisconnect(this._socket, message);\n        } else {\n            this.emit('protocol:error', message);\n            const ack = this._needsAck[message.id];\n            if (ack) {\n                ack.error(message);\n            }\n        }\n    }\n\n    protected _wsInboundAck(message: Ack) {\n        const ack = this._needsAck[message.reply_to];\n        if (ack) {\n            message.error ? ack.error(message.error) : ack.ok(message);\n        }\n    }\n\n    protected _wsInboundOther(message: Other) {\n        this.emit(`${message.type}`, message);\n    }\n\n    protected _wsMessage(evt) {\n        try {\n            this.emit('raw:incomming', evt.data);\n            const message = <Inbound>JSON.parse(evt.data);\n            debug('receive=', message);\n            if (message.type === 'error') {\n                this._wsInboundError(<Error>message);\n            } else if (message.type === 'ack') {\n                this._wsInboundAck(<Ack>message);\n            } else {\n                this._wsInboundOther(<Other>message);\n            }\n        } catch (err) {\n            this.emit('protocol:error', err);\n        }\n    }\n\n    protected _wsError(evt) {\n        this.emit('transport:error', evt);\n        this._wsDisconnect(this._socket, evt);\n    }\n\n    protected _wsClose(evt) {\n        this.emit('transport:close', evt);\n        this._wsDisconnect(this._socket, evt);\n    }\n\n    protected _wsSend(message: Outbound, timeout: number = this.timeout): Promise<Ack> {\n        if (this.status < ConnectionStatus.Connected) {\n            return Promise.reject(new MessageSendError('Cannot send data across a socket that is not connected.', MessageSendErrorCause.NoAuth));\n        }\n\n        debug('send=', message);\n\n        let data;\n        try {\n            data = JSON.stringify(message);\n        } catch (err) {\n            this.emit('protocol:error', err);\n            return Promise.reject(new MessageSendError('Could not serialize message.', MessageSendErrorCause.Serialization, err, message));\n        }\n\n        this.emit('raw:outgoing', data);\n\n        try {\n            const socket = this._socket;\n            socket.send(data);\n            if (socket !== this._socket) {\n                throw new Error('Socket was destroyed during send.');\n            }\n        } catch (err) {\n            debug('send err=', err);\n            this.emit('transport:error', err);\n            return Promise.reject(new MessageSendError('An error occurred in the transport.', MessageSendErrorCause.Transport, err, message));\n        }\n\n        if (message.id) {\n            const id = message.id;\n            const ctx = this._needsAck[id] = <PendingAckContext>{ id };\n            const promise = new Promise((ok, err) => {\n                ctx.ok = ok;\n                ctx.error = err;\n            });\n            const timer = setTimeout(() => {\n                debug('ack timeout=', timeout);\n                ctx.error(new MessageSendError('Did not receive acknowledgement in the timeout period.', MessageSendErrorCause.NoAck, void 0, message));\n            }, timeout);\n            const cleanup = () => {\n                clearTimeout(timer);\n                delete this._needsAck[id];\n            };\n            return promise.then((ack: Ack) => {\n                debug('ack=', ack);\n                cleanup();\n                return ack;\n            }, (err) => {\n                debug('ack error=', err);\n                cleanup();\n                throw new MessageSendError('An error occurred during promise resolution', MessageSendErrorCause.Promise, err, message);\n            });\n        } else {\n            return Promise.resolve(null);\n        }\n    }\n\n    send(message: Outbound): Promise<Ack> {\n        if (this.status < ConnectionStatus.Authenticated) {\n            return Promise.reject(new MessageSendError('Cannot send data across a socket that is not authenticated.', MessageSendErrorCause.NoAuth, void 0, message));\n        }\n        return this._wsSend(message);\n    }\n\n    _ensureCanAck(ack: boolean, message: Outbound): Outbound {\n        if (ack && !('id' in message)) { message.id = this.nextId(); }\n        return message;\n    }\n\n    sendPing(message: Ping = <Ping>{}, ack: boolean = true): Promise<Ack> {\n        message.type = 'ping';\n        return this.send(this._ensureCanAck(ack, message));\n    }\n\n    sendChat(message: Chat, ack: boolean = true): Promise<Ack> {\n        message.type = 'chat';\n        return this.send(this._ensureCanAck(ack, message));\n    }\n\n    sendPresenceChange(message: PresenceChange, ack: boolean = false): Promise<Ack> {\n        message.type = 'presence_change';\n        return this.send(this._ensureCanAck(ack, message));\n    }\n\n    sendUserTyping(message: UserTyping, ack: boolean = false): Promise<Ack> {\n        message.type = 'user_typing';\n        return this.send(this._ensureCanAck(ack, message));\n    }\n\n    sendTeamJoin(message: TeamJoin, ack: boolean = false): Promise<Ack> {\n        message.type = 'team_join';\n        return this.send(this._ensureCanAck(ack, message));\n    }\n\n    sendTeamLeave(message: TeamLeave, ack: boolean = false): Promise<Ack> {\n        message.type = 'team_leave';\n        return this.send(this._ensureCanAck(ack, message));\n    }\n}\n","import { Client } from '../client';\r\n\r\nconst debug: debug.IDebugger = require('debug')('ratatoskr:resume');\r\nconst RESUME_STEPS = [200, 1 * 1000, 5 * 1000, 10 * 1000, 30 * 1000, 60 * 1000]; // 0s, 1s, 5s, 10s, 30s, 60s\r\n\r\nexport interface ResumeOptions {\r\n    ping?: number;\r\n    retry?: number;\r\n    steps?: Array<number>;\r\n    jitter?: number;\r\n}\r\n\r\nexport function resume({ ping = 10 * 1000, retry = 6, steps = RESUME_STEPS, jitter = 1800 }: ResumeOptions = {}) {\r\n    return (client: Client) => {\r\n        let prevAckAt: number, thisAckAt: number;\r\n        let pingTimeout: any;\r\n        let resumeTimeout: any;\r\n        let resumeAttempts: number = 0;\r\n\r\n        function doPing() {\r\n            const msg = {};\r\n            client.emit('resume:ping', msg);\r\n\r\n            debug('ping=', msg);\r\n\r\n            client.sendPing().then((ack) => {\r\n                debug('pong=', ack);\r\n\r\n                prevAckAt = thisAckAt, thisAckAt = Date.now();\r\n                client.emit('resume:pong', ack);\r\n                client.emit('resume:tick', thisAckAt - prevAckAt, thisAckAt, prevAckAt);\r\n                pingTimeout = setTimeout(() => doPing(), ping);\r\n            }, (err) => {\r\n                debug('error=', err);\r\n\r\n                // if the socket is closed, it will trigger a `disconnected` event, which will in turn trigger `doResume`, and then any messages\r\n                // awaiting acknowledgement will be rejected.  In this order of events, the resume process has already begun, so we do not want to\r\n                // disconnect here.\r\n                if (resumeAttempts === 0) {\r\n                    client.disconnect(new Error('pong'));\r\n                }\r\n            });\r\n        }\r\n\r\n        function doResume() {\r\n            resumeAttempts++;\r\n\r\n            if (retry > -1 && resumeAttempts > retry) {\r\n                debug('quit');\r\n\r\n                client.emit('resume:quit');\r\n                return;\r\n            }\r\n\r\n            const resumeDelay = steps[Math.min(resumeAttempts, steps.length) - 1];\r\n\r\n            debug('attempt=', resumeAttempts, resumeDelay);\r\n\r\n            client.emit('resume', resumeDelay, resumeAttempts);\r\n\r\n            clearTimeout(resumeTimeout), resumeTimeout = null;\r\n\r\n            resumeTimeout = setTimeout(() => client.connect(), resumeDelay);\r\n        }\r\n\r\n        client.on('authenticated', () => {\r\n            debug('authenticated');\r\n\r\n            prevAckAt = thisAckAt || Date.now(), thisAckAt = Date.now();\r\n            client.emit('resume:tick', thisAckAt - prevAckAt, thisAckAt, prevAckAt);\r\n            pingTimeout = setTimeout(() => doPing(), ping);\r\n            resumeAttempts = 0;\r\n        });\r\n\r\n        client.on('disconnected', (reason) => {\r\n            debug('disconnected reason=', reason);\r\n\r\n            clearTimeout(pingTimeout), pingTimeout = null;\r\n\r\n            if (reason === client) {\r\n                debug('stop');\r\n\r\n                // disconnect was called directly, do not resume, cancel outstanding\r\n                clearTimeout(resumeTimeout), resumeTimeout = null;\r\n                if (resumeAttempts > 0) {\r\n                    client.emit('resume:stop');\r\n                }\r\n                resumeAttempts = 0;\r\n                return;\r\n            }\r\n\r\n            if (jitter > 0 && resumeAttempts === 0) {\r\n                const randomized = jitter * Math.random();\r\n                debug('jitter first resume attempt=', randomized);\r\n                setTimeout(() => doResume(), randomized);\r\n            } else {\r\n                doResume();\r\n            }            \r\n        });\r\n    };\r\n}\r\n","import { Client } from '../client';\r\nimport { PresenceChange } from '../message-types';\r\n\r\nexport interface PresenceBatchOptions {\r\n    timeout?: number;\r\n}\r\n\r\nexport function presenceBatch({ timeout = 150 }: PresenceBatchOptions = {}) {\r\n    return (client: Client) => {\r\n        let batch: PresenceChange[] = [],\r\n            batchTimeout: any;\r\n\r\n        client.on('presence_change', (presence) => {\r\n            clearTimeout(batchTimeout), batchTimeout = null;\r\n            batch.push(presence);\r\n            batchTimeout = setTimeout(publish, timeout);\r\n        });\r\n\r\n        function publish() {\r\n            let data: PresenceChange[];\r\n            data = batch, batch = [];\r\n            client.emit('presence_change:batch', data);\r\n        }\r\n    };\r\n}\r\n"],"names":["tslib_1.__extends","debug"],"mappings":"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"}